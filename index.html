<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Will you be my Valentine?</title>
        <link rel="stylesheet" href="style.css">
        <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
        <link rel="preload" href="assets/vine.png" as="image">
<link rel="preload" href="assets/couple.png" as="image">
<link rel="preload" href="assets/cloud.png" as="image">
    </head>
    <body>
        <div id="quiz-overlay">
    <div class="quiz-box">
        <h2 id="quiz-question">How many months have we been together?</h2>
        <div id="quiz-options">
            </div>
        <p id="quiz-progress">Question 1 of 5</p>
    </div>
</div>
        <div id="heart-container"></div>
        <header class="main-header">
            <img src="assets/cloud.png" class="header-cloud" alt="Cloud Background">
            <div class="header-text">
                <h1>My Dearest Sane,</h1>
                <h2>A Final Question For You...</h2>
            </div>
        </header>
    <main class="valentine-card">
        <div class="main-content">
            <div class="left-col">
                <div class="pixel-art-container">
                    <img src="assets/couple.png" alt="Pixel Couple" class="couple-img">
                </div>
                
                <div class="question-box">
                    <h3>Will you be my Valentine?</h3>
                    <p>Forever and Always?</p>
                    <div class="button-group">
            <button id="yesBtn" class ="btn yes-btn">YES! A Million Times Yes!</button>
            <button id="noBtn" class="btn no-btn">No! </button>
        </div>
                </div>
            </div>

            <div class="right-col">
                <div class="reasons-box">
                    <h4>Reasons Why I Love You</h4>
                    <ul class="reasons-list">
                        <li>üëÄ Your Eyes</li>
                        <li>üíñ Your Smile</li>
                        <li>ü§ñ Everything About You</li>
                        <li>üåü You push me to be a better person everyday</li>
                        
                    </ul>
                </div>

                <div class="music-player">
                    <div class="heart-pixel">‚ù§Ô∏è<span>Our Songs</span> </div>
                    
                    <iframe data-testid="embed-iframe" style="border-radius:12px" src="https://open.spotify.com/embed/playlist/72rHiH1lK8ChOf7RcUOPDQ?utm_source=generator" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
                </div>
            </div>
            
        </div>
        
    </main>

    <footer class="main-footer">
  <p>Coded with love for my favorite person Aayushu</p>
  <div class="heart">‚ù§Ô∏è</div>
</footer>

<div id="success-screen" class="success-hidden">
    <div class="success-box">
        <img src="assets/couple.png" alt="Happy Couple" class="success-img">
        <h1>Yay! Of Course How could you say no to me! üòâ‚ù§Ô∏è</h1>
        <h2>I LOVE YOU! ü´∂</h2>
        <button class="button" onclick="closeSuccess()">Back to Garden</button>
    </div>
</div>
<audio id="success-sound" src="assets/CHEER.mp3" preload="auto"></audio>
<audio id="kiss-sound" src="assets/Kiss.mp3" preload="auto"></audio>


   <script>
// 1. Preload Assets
const assetsToPreload = [
    'assets/cloud.png',
    'assets/vine.png',
    'assets/couple.png',
    'assets/CHEER.mp3',
    'assets/Kiss.mp3'
];

assetsToPreload.forEach(src => {
    if (src.endsWith('.mp3')) {
        const audio = new Audio();
        audio.src = src;
    } else {
        const img = new Image();
        img.src = src;
    }
});

// 2. Quiz Data
const questions = [
    { q: "Where was our first date?", options: ["Chick-fila", "The Movies", "Nightclub", "Online"], a: 0 },
    { q: "What's my favorite color on you?", options: ["Red", "Yellow", "Blue", "Black"], a: 1 },
    { q: "What's my birth date?", options: ["09/20/2058", "08/31/2060", "05/31/2060", "04/21/2061"], a: 2 },
    { q: "Do I love you?", options: ["No", "A little", "Yes, obviously", "Not at all"], a: 2  },
    { q: "How much do you love me?", options: ["A little", "A lot", "More than yourself", "More than Momo"], a: 3, loop: true },
];

let currentQ = 0;
let score = 0;
let currentPadding = 15;
let currentFontSize = 1;

// 3. Functions
function loadQuestion() {
    const qData = questions[currentQ];
    document.getElementById('quiz-question').innerText = qData.q;
    document.getElementById('quiz-progress').innerText = `Question ${currentQ + 1} of ${questions.length}`;
    
    const optionsDiv = document.getElementById('quiz-options');
    optionsDiv.innerHTML = "";
    
    qData.options.forEach((opt, index) => {
        const btn = document.createElement('button');
        btn.innerText = opt;
        btn.className = 'quiz-btn';
        // Fixed for Mobile/Desktop
        btn.onclick = (e) => {
            e.preventDefault();
            handleAnswer(index);
        };
        optionsDiv.appendChild(btn);
    });
}

function handleAnswer(choice) {
    const qData = questions[currentQ];

    if (qData.loop) {
        if (choice === qData.a) {
            score++;
            currentQ++;
        } else {
            const box = document.querySelector('.quiz-box');
            box.classList.add('shake');
            setTimeout(() => box.classList.remove('shake'), 500);
            alert("Are you sure? Try again...! üòâ");
            return; 
        }
    } else {
        if (choice === qData.a) { score++; }
        currentQ++;
    }

    if (currentQ < questions.length) {
        loadQuestion();
    } else {
        finishQuiz();
    }
}

function finishQuiz() {
    const finalScore = (score / questions.length) * 100;
    if (finalScore >= 90) {
        document.getElementById('quiz-overlay').classList.add('quiz-passed');
        setInterval(createHeart, 300);
    } else {
        alert(`You got ${finalScore}%. Try again! ‚ù§Ô∏è`);
        currentQ = 0;
        score = 0;
        loadQuestion();
    }
}

const moveButton = () => {
    const noBtn = document.getElementById('noBtn');
    const yesBtn = document.getElementById('yesBtn');
    const padding = 50;
    const maxWidth = window.innerWidth - noBtn.offsetWidth - padding;
    const maxHeight = window.innerHeight - noBtn.offsetHeight - padding;

    const x = Math.max(padding, Math.random() * maxWidth);
    const y = Math.max(padding, Math.random() * maxHeight);
    
    noBtn.style.position = 'fixed';
    noBtn.style.left = `${x}px`;
    noBtn.style.top = `${y}px`;
    noBtn.style.zIndex = '100000';
    
    currentPadding += 5; 
    currentFontSize += 0.1; 
    yesBtn.style.padding = `${currentPadding}px ${currentPadding * 1.5}px`;
    yesBtn.style.fontSize = `${currentFontSize}rem`;
};

// Event Listeners
document.getElementById('noBtn').addEventListener('mouseover', moveButton);
document.getElementById('noBtn').addEventListener('touchstart', (e) => {
    e.preventDefault();
    moveButton();
});

document.getElementById('yesBtn').addEventListener('click', () => {
    const success = document.getElementById('success-screen');
    const cheer = document.getElementById('success-sound');
    const kiss = document.getElementById('kiss-sound');

    cheer.volume = 0.5;
    cheer.play();
    cheer.onended = () => { kiss.play(); };

    success.classList.remove('success-hidden');
    setTimeout(() => {
        success.classList.add('show');
        for(let i = 0; i < 100; i++) {
            setTimeout(createHeart, i * 20); 
        }
    }, 10);
});

function createHeart() {
    const container = document.getElementById('heart-container');
    if (!container) return;
    const heart = document.createElement('div');
    heart.classList.add('floating-heart');
    const heartTypes = ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó', 'üíù'];
    heart.textContent = heartTypes[Math.floor(Math.random() * heartTypes.length)];
    heart.style.left = Math.random() * 100 + 'vw';
    heart.style.fontSize = (Math.random() * 20 + 10) + 'px';
    heart.style.animationDuration = (Math.random() * 3 + 4) + 's';
    heart.style.opacity = Math.random() * 0.5 + 0.5;
    container.appendChild(heart);
    setTimeout(() => { heart.remove(); }, 7000);
}

function closeSuccess() {
    const success = document.getElementById('success-screen');
    success.classList.remove('show');
    setTimeout(() => success.classList.add('success-hidden'), 500);
    document.getElementById('success-sound').pause();
    document.getElementById('kiss-sound').pause();
    document.querySelector('.button-group').style.display = 'none';
    document.getElementById('noBtn').style.display = 'none';
    document.querySelector('.question-box h3').innerText = "You're my Valentine! ‚ù§Ô∏è";
    document.querySelector('.question-box p').innerText = "Forever and Always";
}

// Kick it off
loadQuestion();
</script>

</body>
</html>
